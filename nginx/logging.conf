log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                '$status $body_bytes_sent "$http_referer" '
                '"$http_user_agent" "$http_x_forwarded_for"';

log_format json escape=json '{'
    '"timestamp":"$time_iso8601",'
    '"remote_addr":"$remote_addr",'
    '"remote_user":"$remote_user",'
    '"request":"$request",'
    '"status":"$status",'
    '"body_bytes_sent":"$body_bytes_sent",'
    '"request_time":"$request_time",'
    '"http_referer":"$http_referer",'
    '"http_user_agent":"$http_user_agent",'
    '"http_x_forwarded_for":"$http_x_forwarded_for",'
    '"upstream_response_time":"$upstream_response_time"'
'}';

log_format performance '$remote_addr - [$time_local] "$request" '
                      '$status $body_bytes_sent $request_time '
                      '"$http_user_agent"';

log_format security '$remote_addr - [$time_local] "$request" '
                   '$status "$http_referer" "$http_user_agent" '
                   '"$server_name" blocked';